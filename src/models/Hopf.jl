function rhs(x,t,p)
    return [x[3]*x[1]-x[2]+x[1]*(x[1]^2+x[2]^2), x[1]+x[3]*x[2]+x[2]*(x[1]^2+x[2]^2), 0]
end

function rhs(t,x::Array{T,2}) where {T<:Number}
    return [x[3,:]'.*x[1,:]'.-x[2,:]'.+x[1,:]'.*(x[1,:]'.^2 .+x[2,:]'.^2); x[1,:]'.+x[3,:]'.*x[2,:]'.+x[2,:]'.*(x[1,:]'.^2 .+ x[2,:]'.^2); zeros(size(x)[2])']
end

function rhs(x)
    return [x[3,:]'.*x[1,:]'.-x[2,:]'.+x[1,:]'.*(x[1,:]'.^2 .+x[2,:]'.^2); x[1,:]'.+x[3,:]'.*x[2,:]'.+x[2,:]'.*(x[1,:]'.^2 .+x[2,:]'.^2); 0.0f0 .* x[1,:]']
end
